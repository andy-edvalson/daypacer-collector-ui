<!DOCTYPE html>
<html>
  <head>
    <script src="https://unpkg.com/ag-grid/dist/ag-grid.min.noStyle.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/ag-grid/dist/styles/ag-grid.css">
    <link rel="stylesheet" href="https://unpkg.com/ag-grid/dist/styles/ag-theme-balham.css">

  </head>
  <body>
    <h1>Daypacer Calls</h1>

    <a href="test_post.html">Test Form for Call API</a><hr/>

    <button onclick="getSelectedRows()">Get Selected Rows</button>
    <div id="myGrid" style="height: 600px;width:100%;" class="ag-theme-balham"></div>

    <script type="text/javascript" charset="utf-8">
      // specify the columns
      var columnDefs = [
        {headerName: "First", field: "first_name"},
        {headerName: "Last", field: "last_name"},
        {headerName: "Phone", field: "phone"},
        {headerName: "City", field: "city"},
        {headerName: "State", field: "state"},
        {headerName: "Zip Code", field: "zip"},
        {headerName: "URL", field: "url"},
        {headerName: "Vendor Name", field: "vendor"},
        {headerName: "IP Address", field: "ip"}
      ];

      // let the grid know which columns and what data to use
      var gridOptions = {
        enableSorting: true,
        enableFilter: true,
        columnDefs: columnDefs,
        rowSelection: 'multiple'
      };

    // lookup the container we want the Grid to use
    var eGridDiv = document.querySelector('#myGrid');

    // create the grid passing in the div to use together with the columns & data we want to use
    new agGrid.Grid(eGridDiv, gridOptions);

    fetch('https://b2bs80vdrl.execute-api.us-west-2.amazonaws.com/Prototype/call').then(function(response) {
      return response.json();
    }).then(function(data) {
      gridOptions.api.setRowData(data.response);
    })

    function getSelectedRows() {
      var selectedNodes = gridOptions.api.getSelectedNodes()
      var selectedData = selectedNodes.map( function(node) { return node.data })
      var selectedDataStringPresentation = selectedData.map( function(node) { return node.id }).join(', ')
      alert('Selected nodes: ' + selectedDataStringPresentation);
    }

    </script>
  </body>
</html>
